# W25QXX

非易失性存储器
一种Flash(闪存) Nor Flash / Nand Flash 这里用的是第一个
前者适合高速智能 后者适合低速大量

W25Q64 能存64MBit = 8MByte

用24位地址作为地址寻址,其最大能寻址到16MByte,故对于这个系列的寻址绰绰有余,除了W25Q256,它能存储32MByte

存储器内部按级划分为块(block),扇区(sector),页(page)
一个块有64个千字节(64 * 1024 Byte),存储器被分为了128个块
一个扇区有4个千字节(4096 Byte),一个块被分为16个扇区
一页有256个字节,一个扇区被分为16页

# 寻址

24位地址由3位字节组成,在通信时需连续发送3个字节
前两个字节表示页的位置(哪个块的哪个扇区)
后一字节表示字节在页中的位置

0x7F F F FF

7F 块编号

F F 哪个扇区的哪个页

FF 表示这个页的第几个字节

# 擦除和写入(Flash操作注意事项)

1. 每次写入前,必须先进行写使能
2. 每个数据位只能从1改写为0,不能从0改写为1
3. 写入数据前必须先擦除,执行完后,所有数据位变为1(相当于直接全部写1,也不对和上面的冲突了)
4. 擦除必须按最小擦除单元进行:扇区(4096 Byte)(**意味着最小擦除单位为扇区**)
5. 连续写多字节的时候,最多写入一页的数据(256字节),超出则会发生回绕(这是由于写入时是先写入256字节的RAM缓冲区,然后才转入到Flash里的,因为RAM速度很快,能跟上spi的速度,而Flash不行)
6. 写入和擦除操作后,芯片进入忙状态,此时将不会相应新的读写操作(可看状态寄存器判断是否退出状态)
7. 读的话,无需使能,无需额外操作,也没有页的限制
8. 读操作结束后芯片不会进入忙的状态,但不能在芯片忙状态时读取

# 重要项

## 状态寄存器

SR1 的 BUSY比较重要 忙状态位 还有WEL(Write Enable Latch,写使能锁存器),这个在每次写操作前,必须要进行写使能,一个写使能只能保证后续一个写操作可以执行

# 使用体验

1. 每次写入(页编程,擦除)都需要写使能,每写一次都要!
2. 当芯片处于忙状态时,无法写入和读取,因为它根本不鸟你
3. 无论你要干什么,必须先拉低CS线,并且拉低后紧随着的就要是指令,然后才是地址等待之类的东西
4. 写入前必须要擦除扇区,且擦除扇区需要时间,加个延时等一会
